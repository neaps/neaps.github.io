(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{"+M1K":function(e,t,r){var n=r("WSbT"),a=RangeError;e.exports=function(e){var t=n(e);if(t<0)throw a("The argument can't be less than 0");return t}},"0rvr":function(e,t,r){var n=r("4zBA"),a=r("glrk"),o=r("O741");e.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var e,t=!1,r={};try{(e=n(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),t=r instanceof Array}catch(i){}return function(r,n){return a(r),o(n),t?e(r,n):r.__proto__=n,r}}():void 0)},"4WOD":function(e,t,r){var n=r("Gi26"),a=r("Fib7"),o=r("ewvW"),i=r("93I0"),c=r("4Xet"),u=i("IE_PROTO"),l=Object,f=l.prototype;e.exports=c?l.getPrototypeOf:function(e){var t=o(e);if(n(t,u))return t[u];var r=t.constructor;return a(r)&&t instanceof r?r.prototype:t instanceof l?f:null}},"4Xet":function(e,t,r){var n=r("0Dky");e.exports=!n((function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}))},"4fRq":function(e,t,r){r("PF2M"),r("IZzc");var n="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(n){var a=new Uint8Array(16);e.exports=function(){return n(a),a}}else{var o=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),o[t]=e>>>((3&t)<<3)&255;return o}}},"67WC":function(e,t,r){"use strict";var n,a,o,i=r("qYE9"),c=r("g6v/"),u=r("2oRo"),l=r("Fib7"),f=r("hh1v"),s=r("Gi26"),p=r("9d/t"),d=r("DVFp"),m=r("kRJp"),y=r("yy0I"),v=r("m/L8").f,h=r("OpvP"),g=r("4WOD"),b=r("0rvr"),E=r("tiKp"),O=r("kOOl"),A=r("afO8"),T=A.enforce,w=A.get,x=u.Int8Array,j=x&&x.prototype,C=u.Uint8ClampedArray,F=C&&C.prototype,S=x&&g(x),k=j&&g(j),U=Object.prototype,I=u.TypeError,R=E("toStringTag"),_=O("TYPED_ARRAY_TAG"),D=i&&!!b&&"Opera"!==p(u.opera),V=!1,M={Int8Array:1,Uint8Array:1,Uint8ClampedArray:1,Int16Array:2,Uint16Array:2,Int32Array:4,Uint32Array:4,Float32Array:4,Float64Array:8},P={BigInt64Array:8,BigUint64Array:8},W=function(e){var t=g(e);if(f(t)){var r=w(t);return r&&s(r,"TypedArrayConstructor")?r.TypedArrayConstructor:W(t)}},z=function(e){if(!f(e))return!1;var t=p(e);return s(M,t)||s(P,t)};for(n in M)(o=(a=u[n])&&a.prototype)?T(o).TypedArrayConstructor=a:D=!1;for(n in P)(o=(a=u[n])&&a.prototype)&&(T(o).TypedArrayConstructor=a);if((!D||!l(S)||S===Function.prototype)&&(S=function(){throw I("Incorrect invocation")},D))for(n in M)u[n]&&b(u[n],S);if((!D||!k||k===U)&&(k=S.prototype,D))for(n in M)u[n]&&b(u[n].prototype,k);if(D&&g(F)!==k&&b(F,k),c&&!s(k,R))for(n in V=!0,v(k,R,{get:function(){return f(this)?this[_]:void 0}}),M)u[n]&&m(u[n],_,n);e.exports={NATIVE_ARRAY_BUFFER_VIEWS:D,TYPED_ARRAY_TAG:V&&_,aTypedArray:function(e){if(z(e))return e;throw I("Target is not a typed array")},aTypedArrayConstructor:function(e){if(l(e)&&(!b||h(S,e)))return e;throw I(d(e)+" is not a typed array constructor")},exportTypedArrayMethod:function(e,t,r,n){if(c){if(r)for(var a in M){var o=u[a];if(o&&s(o.prototype,e))try{delete o.prototype[e]}catch(i){try{o.prototype[e]=t}catch(l){}}}k[e]&&!r||y(k,e,r?t:D&&j[e]||t,n)}},exportTypedArrayStaticMethod:function(e,t,r){var n,a;if(c){if(b){if(r)for(n in M)if((a=u[n])&&s(a,e))try{delete a[e]}catch(o){}if(S[e]&&!r)return;try{return y(S,e,r?t:D&&S[e]||t)}catch(o){}}for(n in M)!(a=u[n])||a[e]&&!r||y(a,e,t)}},getTypedArrayConstructor:W,isView:function(e){if(!f(e))return!1;var t=p(e);return"DataView"===t||s(M,t)||s(P,t)},isTypedArray:z,TypedArray:S,TypedArrayPrototype:k}},EcEN:function(e,t,r){var n=r("xDdU"),a=r("xk4V"),o=a;o.v1=n,o.v4=a,e.exports=o},GC2F:function(e,t,r){var n=r("+M1K"),a=RangeError;e.exports=function(e,t){var r=n(e);if(r%t)throw a("Wrong offset");return r}},I2ZF:function(e,t){for(var r=[],n=0;n<256;++n)r[n]=(n+256).toString(16).substr(1);e.exports=function(e,t){var n=t||0,a=r;return[a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],"-",a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]],a[e[n++]]].join("")}},IZzc:function(e,t,r){"use strict";var n=r("2oRo"),a=r("4zBA"),o=r("0Dky"),i=r("We1y"),c=r("rdv8"),u=r("67WC"),l=r("BNF5"),f=r("2Zix"),s=r("LQDL"),p=r("USzg"),d=u.aTypedArray,m=u.exportTypedArrayMethod,y=n.Uint16Array,v=y&&a(y.prototype.sort),h=!(!v||o((function(){v(new y(2),null)}))&&o((function(){v(new y(2),{})}))),g=!!v&&!o((function(){if(s)return s<74;if(l)return l<67;if(f)return!0;if(p)return p<602;var e,t,r=new y(516),n=Array(516);for(e=0;e<516;e++)t=e%4,r[e]=515-e,n[e]=e-2*t+3;for(v(r,(function(e,t){return(e/4|0)-(t/4|0)})),e=0;e<516;e++)if(r[e]!==n[e])return!0}));m("sort",(function(e){return void 0!==e&&i(e),g?v(this,e):c(d(this),function(e){return function(t,r){return void 0!==e?+e(t,r)||0:r!=r?-1:t!=t?1:0===t&&0===r?1/t>0&&1/r<0?1:-1:t>r}}(e))}),!g||h)},O741:function(e,t,r){var n=r("Fib7"),a=String,o=TypeError;e.exports=function(e){if("object"==typeof e||n(e))return e;throw o("Can't set "+a(e)+" as a prototype")}},PF2M:function(e,t,r){"use strict";var n=r("2oRo"),a=r("xluM"),o=r("67WC"),i=r("B/qT"),c=r("GC2F"),u=r("ewvW"),l=r("0Dky"),f=n.RangeError,s=n.Int8Array,p=s&&s.prototype,d=p&&p.set,m=o.aTypedArray,y=o.exportTypedArrayMethod,v=!l((function(){var e=new Uint8ClampedArray(2);return a(d,e,{length:1,0:3},1),3!==e[1]})),h=v&&o.NATIVE_ARRAY_BUFFER_VIEWS&&l((function(){var e=new s(2);return e.set(1),e.set("2",1),0!==e[0]||2!==e[1]}));y("set",(function(e){m(this);var t=c(arguments.length>1?arguments[1]:void 0,1),r=u(e);if(v)return a(d,this,r,t);var n=this.length,o=i(r),l=0;if(o+t>n)throw f("Wrong length");for(;l<o;)this[t+l]=r[l++]}),!v||h)},PP2V:function(e,t,r){"use strict";r.r(t);var n,a,o,i,c,u=r("MUpH"),l=r("q1tI"),f=r.n(l),s=r("qQpU"),p=r("+e4l"),d=r("EcEN"),m=r.n(d),y=r("5D9J"),v=y.default.div(n||(n=Object(u.a)(["\n  background: tomato;\n  color: #fff;\n  padding: 1rem;\n"]))),h=r("uevz"),g=r("BXTI"),b=r("V9x4"),E=r("gkfb"),O=r("17x9"),A=r.n(O),T=r("x+sP"),w=r("+ZDr"),x=r.n(w),j="\n  border: 0;\n  background: "+T.a.primary.dark+";\n  color: "+T.a.primary.light+" !important;\n  padding: 0.5rem;\n  display: inline-block;\n  cursor: pointer;\n  text-align: left;\n";y.default.button(a||(a=Object(u.a)(["\n  ",";\n"])),j).propTypes={children:A.a.node},y.default.a(o||(o=Object(u.a)(["\n  ",";\n  text-decoration: none;\n"])),j).propTypes={children:A.a.node,href:A.a.string},Object(y.default)(x.a)(i||(i=Object(u.a)(["\n  ",";\n  text-decoration: none;\n"])),j).propTypes={children:A.a.node,to:A.a.string};var C=y.default.button(c||(c=Object(u.a)(["\n  border: 0;\n  padding: 0;\n  text-align: left;\n  background: transparent;\n  color: ",";\n  text-decoration: underline;\n  cursor: pointer;\n"])),T.a.link);C.propTypes={children:A.a.node};var F,S,k,U,I=r("V0Ns"),R=r("bNI1"),_=r("f0Wu"),D=r.n(_),V=r("m+UU"),M=y.default.pre(F||(F=Object(u.a)(["\n  color: #fff;\n  background: rgb(42, 39, 52);\n  padding: 1rem;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-size: 0.8rem;\n  white-space: pre-wrap;\n"]))),P=Object(y.default)(I.b)(S||(S=Object(u.a)(["\n  font-family: monospace;\n"]))),W=Object(y.default)(E.Flex)(k||(k=Object(u.a)(["\n  border-top: "," 2px solid;\n"])),T.a.primary.dark),z=Object(y.default)(E.Box)(U||(U=Object(u.a)(["\n  background: ",";\n  color: #fff;\n"])),T.a.primary.dark),q=[];R.zones.forEach((function(e){e=e.split("|"),q.push(e[0])}));var B=function(e,t,r,n,a,o){t=void 0!==t?t:",",r=void 0!==r?r:"metric",o=void 0!==o&&o-1,n=void 0!==n?n:"timestamp";var i=[],c=!1;return e.split(/\n/).forEach((function(e,u){if(!c)if(2===e.split(t).length){var l=parseFloat(e.split(t)[1].trim()),f=function(e,t,r){r=r||"Etc/UTC";var n=0;return"timestamp"===(t=t||"timestamp")&&(n=e),"iso"===t&&(n=new Date(e).getTime()/1e3),D.a.unix(n).tz(r).toISOString(!0)}(e.split(t)[0].trim(),n,a);f||(c="Line "+(u+1)+" has an un-parseable time."),o&&u>=o||i.push({t:f,v:"metric"===r?l:l/3.2808})}else c="Line "+(u+1)+' does not contain the delimiter "'+t+'".'})),{results:i,error:c}},N=function(e){var t=e.message;return f.a.createElement(p.a,null,f.a.createElement(b.a,null,"Computing tidal constituents."),f.a.createElement(M,null,t.join("")))};t.default=function(e){var t=e.data.site.siteMetadata,r=t.harmonicsServer,n=t.harmonicsSocket,a=Object(l.useState)(!1),o=a[0],i=a[1],c=Object(l.useState)(!1),u=c[0],d=c[1],y=Object(l.useState)("metric"),b=y[0],O=y[1],A=Object(l.useState)(","),T=A[0],w=A[1],x=Object(l.useState)("Etc/UTC"),j=x[0],F=x[1],S=Object(l.useState)("timestamp"),k=S[0],U=S[1],R=Object(l.useState)(!1),_=R[0],D=R[1],M=Object(l.useState)(!1),G=M[0],Y=M[1],J=Object(l.useState)(!1),Z=J[0],L=J[1],X=Object(l.useState)([]),K=X[0],H=X[1];return Object(l.useEffect)((function(){fetch(r)}),[]),f.a.createElement(s.a,{title:"Generate tide harmonics"},Z?f.a.createElement(N,{message:K}):f.a.createElement(f.a.Fragment,null,_?f.a.createElement(V.default,{harmonics:_,id:u,dataTimezone:j,levels:B(o,T,b,k,j)}):f.a.createElement(W,null,f.a.createElement(E.Box,{width:[.5],p:4},f.a.createElement(p.a,null,f.a.createElement("form",{onSubmit:function(e){e.preventDefault(),Y(!0);var t=m()(),a=B(o,T,b,k,j);fetch(r+"generate",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({uuid:t,timezone:j,levels:a.results})}).then((function(e){d(t),L(!0),K.push("Starting harmonics generator server...\n\n"),H(K);var a=new WebSocket(n);a.onopen=function(e){a.send(JSON.stringify({uuid:t}))},a.onmessage=function(e){var n=JSON.parse(e.data),o=n.type,i=n.data;"message"!==o&&"error"!==o||(K.push(i),H(K)),"close"!==o&&"exit"!==o||(K.push("\n\nFetching harmonic data"),H(K),fetch(r+"get/"+t).then((function(e){return e.json()})).then((function(e){D(e),L(!1),a.close()})).catch((function(e){console.log("Get error")})))}}))}},o?f.a.createElement(f.a.Fragment,null,f.a.createElement("p",null,f.a.createElement(C,{onClick:function(e){e.preventDefault(),i(!1)}},"Start over")),f.a.createElement("label",{htmlFor:"delimiter"},"Field delimiter"),f.a.createElement(I.a,null,"The string that separates time and water level, i.e. a comma for CSV files."," "),f.a.createElement(P,{id:"delimiter",defaultValue:",",onChange:function(e){w(e.target.value)}}),f.a.createElement("label",{htmlFor:"units"},"Units"),f.a.createElement(I.c,{id:"units",onChange:function(e){O(e.target.value)}},f.a.createElement("option",{value:"metric"},"Metric"),f.a.createElement("option",{value:"english"},"English")),f.a.createElement("label",{htmlFor:"time-format"},"Time format"),f.a.createElement(I.c,{id:"time-format",onChange:function(e){U(e.target.value)}},f.a.createElement("option",{value:"timestamp"},"UNIX timestamp"),f.a.createElement("option",{value:"iso"},"ISO-formatted")),f.a.createElement("label",{htmlFor:"timezone_data"},"Timezone of data"),f.a.createElement(I.c,{id:"timezone_data",onChange:function(e){F(e.target.value)}},f.a.createElement("option",{value:"Etc/UTC"},"UTC/GMT"),q.map((function(e){return f.a.createElement("option",{key:e,value:e},e)}))),G?f.a.createElement(I.d,{value:"Uploading data",disabled:"disabled"}):f.a.createElement(I.d,{value:"Confirm data"})):f.a.createElement(f.a.Fragment,null,f.a.createElement("h3",{id:"data-file-label"},"Data file"),f.a.createElement("p",null,"Tide constituents should be derived from good data that is sampled at least once an hour, and over a year or more."),f.a.createElement(I.a,null,"Your file should be in a simple CSV format, without quotes:"),f.a.createElement(g.a,{code:"2009-01-01 13:00:00, 1.23\n2009-01-01 14:00:00, -1.150\n2009-01-01 15:00:00, 1.53",language:"text"}),f.a.createElement(I.b,{type:"file","aria-labelledby":"data-file-label",onChange:function(e){var t=new FileReader;t.onloadend=function(){i(t.result)},t.readAsText(e.target.files[0])}}))))),f.a.createElement(z,{width:[.5],p:4},f.a.createElement("h3",null,"Preview"),o&&f.a.createElement(f.a.Fragment,null,B(o,T,b,k,j,10).error?f.a.createElement(v,null,B(o,T,b,k,j,10).error):f.a.createElement(f.a.Fragment,null,f.a.createElement("p",null,"All dates are in UTC, heights in meters."),f.a.createElement(h.a,{light:!0},f.a.createElement("thead",null,f.a.createElement("tr",null,f.a.createElement("th",null,"Date & time"),f.a.createElement("th",null,"Water level"))),f.a.createElement("tbody",null,B(o,T,b,k,j,10).results.map((function(e,t){return f.a.createElement("tr",{key:"preview-"+t},f.a.createElement("td",null,e.t),f.a.createElement("td",null,e.v))}))))))))))}},V0Ns:function(e,t,r){"use strict";r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return y})),r.d(t,"e",(function(){return v})),r.d(t,"d",(function(){return g})),r.d(t,"a",(function(){return b}));var n,a,o,i,c,u=r("MUpH"),l=r("q1tI"),f=r.n(l),s=r("5D9J"),p=r("x+sP"),d="\n  padding: 0.5rem;\n  border: "+p.a.primary.dark+" 2px solid;\n  margin-bottom: 1rem;\n  width: 100%;\n",m=s.default.input(n||(n=Object(u.a)(["\n  ","\n"])),d),y=s.default.select(a||(a=Object(u.a)(["\n  ","\n  border-radius: 0;\n"])),d),v=s.default.textarea(o||(o=Object(u.a)(["\n  ","\n"])),d),h=s.default.input(i||(i=Object(u.a)(["\n  border: 0;\n  background: ",";\n  color: #fff;\n  padding: 0.5rem;\n  cursor: pointer;\n"])),p.a.primary.dark),g=function(e){var t=e.value;return f.a.createElement(h,{type:"submit",value:t})},b=s.default.p(c||(c=Object(u.a)(["\n  font-size: 0.8rem;\n  margin-bottom: 0;\n"])))},qYE9:function(e,t){e.exports="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView},xDdU:function(e,t,r){var n,a,o=r("4fRq"),i=r("I2ZF"),c=0,u=0;e.exports=function(e,t,r){var l=t&&r||0,f=t||[],s=(e=e||{}).node||n,p=void 0!==e.clockseq?e.clockseq:a;if(null==s||null==p){var d=o();null==s&&(s=n=[1|d[0],d[1],d[2],d[3],d[4],d[5]]),null==p&&(p=a=16383&(d[6]<<8|d[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),y=void 0!==e.nsecs?e.nsecs:u+1,v=m-c+(y-u)/1e4;if(v<0&&void 0===e.clockseq&&(p=p+1&16383),(v<0||m>c)&&void 0===e.nsecs&&(y=0),y>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");c=m,u=y,a=p;var h=(1e4*(268435455&(m+=122192928e5))+y)%4294967296;f[l++]=h>>>24&255,f[l++]=h>>>16&255,f[l++]=h>>>8&255,f[l++]=255&h;var g=m/4294967296*1e4&268435455;f[l++]=g>>>8&255,f[l++]=255&g,f[l++]=g>>>24&15|16,f[l++]=g>>>16&255,f[l++]=p>>>8|128,f[l++]=255&p;for(var b=0;b<6;++b)f[l+b]=s[b];return t||i(f)}},xk4V:function(e,t,r){var n=r("4fRq"),a=r("I2ZF");e.exports=function(e,t,r){var o=t&&r||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var i=(e=e||{}).random||(e.rng||n)();if(i[6]=15&i[6]|64,i[8]=63&i[8]|128,t)for(var c=0;c<16;++c)t[o+c]=i[c];return t||a(i)}}}]);
//# sourceMappingURL=component---src-pages-harmonics-index-js-fe13a4f7a300b4a3fa7d.js.map